<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposta Comercial | Engenharia de Precis√£o</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Google Fonts: Suisse Intl (similar) & Inter -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@700;800&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Phosphor Icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    
    <!-- Swiper.js for Carousel -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

    <!-- GSAP for Advanced Animations -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/ScrollTrigger.min.js"></script>

    <!-- QR Code Generator Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>

    <style>
        :root {
            --color-primary: #0A2463;
            --color-secondary: #1E293B;
            --color-accent: #059669;
            --color-highlight: #B45309;
            --color-neutral-light: #F8FAFC;
            --color-neutral-dark: #475569;
            --font-heading: 'Plus Jakarta Sans', sans-serif;
            --font-body: 'Inter', sans-serif;
        }

        body {
            font-family: var(--font-body);
            background-color: var(--color-primary);
            color: var(--color-secondary);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }
        
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: var(--color-secondary); }
        ::-webkit-scrollbar-thumb { background: var(--color-accent); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #06b6d4; }

        .section-title {
            font-family: var(--font-heading);
            color: var(--color-primary);
        }
        .section-subtitle {
            color: var(--color-neutral-dark);
        }
        .content-wrapper {
            background-color: #FFFFFF;
            border-radius: 40px 40px 0 0;
            margin-top: -30px;
            position: relative;
            z-index: 20;
            overflow: hidden; /* Fix for margins collapsing */
        }

        /* --- Dark Section Overrides --- */
        .section-dark {
            background-color: var(--color-secondary);
        }
        .section-dark .section-title {
            color: #FFFFFF;
        }
        .section-dark .section-subtitle {
            color: #cbd5e1; /* slate-300 */
        }
        .section-dark .tab-button {
            color: #cbd5e1;
        }
        .section-dark .tab-button.active {
            color: var(--color-accent);
            border-bottom-color: var(--color-accent);
        }
        .section-dark .tab-content h3 {
             color: #FFFFFF;
        }
        .section-dark .tab-content p, .section-dark .tab-content ul {
            color: #cbd5e1;
        }
        .section-dark .faq-item {
            background-color: #334155; /* slate-700 */
            border-color: #475569; /* slate-600 */
        }
        .section-dark .faq-item summary {
            color: #FFFFFF;
        }
        .section-dark .faq-item div {
            color: #cbd5e1;
        }
        .section-dark #profile-content h3 {
            color: #FFFFFF;
        }
        .section-dark #profile-content p {
            color: #cbd5e1;
        }

        /* Header */
        #main-header {
            transition: background-color 0.4s ease-in-out, box-shadow 0.4s ease-in-out;
        }
        #main-header.scrolled {
            background-color: rgba(10, 36, 99, 0.7);
            backdrop-filter: blur(16px);
            -webkit-backdrop-filter: blur(16px);
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        .nav-link {
            position: relative;
            padding-bottom: 8px;
            transition: color 0.3s;
        }
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 2px;
            background-color: var(--color-accent);
            transition: width 0.4s cubic-bezier(0.25, 1, 0.5, 1);
        }
        .nav-link:hover::after, .nav-link.active::after {
            width: 100%;
        }

        /* Hero */
        .hero-bg-video {
            position: absolute;
            top: 50%;
            left: 50%;
            width: auto;
            height: auto;
            min-width: 100%;
            min-height: 100%;
            transform: translate(-50%, -50%);
            z-index: 1;
        }

        /* Glassmorphism Card (Advanced) */
        .glass-card {
            background: rgba(255, 255, 255, 0.1);
            border-radius: 24px;
            box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        .glass-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px 0 rgba(0, 0, 0, 0.2);
        }

        /* Solutions Tabs */
        .tabs-container {
            overflow-x: auto;
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        .tabs-container::-webkit-scrollbar {
            display: none; /* Hide scrollbar for Chrome, Safari and Opera */
        }
        #tabs-buttons {
            flex-wrap: nowrap;
            white-space: nowrap;
        }
        .tab-button {
            transition: all 0.3s ease;
            border-bottom: 2px solid transparent;
            flex-shrink: 0;
        }
        .tab-button.active {
            color: var(--color-accent);
            border-bottom-color: var(--color-accent);
        }
        .tab-content { display: none; }
        .tab-content.active { display: block; }
        
        /* Portfolio */
        .portfolio-card {
            transition: transform 0.4s, box-shadow 0.4s;
        }
        .portfolio-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 20px 40px rgba(30, 41, 59, 0.1);
        }
        
        /* Timeline */
        .timeline-item {
            position: relative;
            padding-left: 40px;
            padding-bottom: 40px;
            border-left: 2px solid #e2e8f0;
        }
        .timeline-item:last-child {
            border-left: 2px solid transparent;
        }
        .timeline-marker {
            position: absolute;
            top: 0;
            left: -11px;
            width: 20px;
            height: 20px;
            background-color: white;
            border: 4px solid var(--color-primary);
            border-radius: 50%;
            transition: background-color 0.3s, transform 0.3s;
        }
        .timeline-item.in-view .timeline-marker {
            background-color: var(--color-accent);
            transform: scale(1.1);
        }

        /* Package Cards (Neumorphism Evolved) */
        .package-card {
            background: var(--color-neutral-light);
            border-radius: 20px;
            transition: transform 0.3s, box-shadow 0.3s;
            border: 1px solid #e2e8f0;
        }
        .package-card.recommended {
            border-color: var(--color-accent);
            transform: scale(1.05);
            z-index: 10;
        }
        .package-card:hover {
            transform: translateY(-12px) scale(1.02);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.1);
        }
        .package-card.recommended:hover {
            transform: translateY(-12px) scale(1.08);
        }
        .package-cta {
            transition: all 0.3s ease;
        }
        .package-card:hover .package-cta span {
            letter-spacing: 0.5px;
        }
        .package-cta i {
            transition: transform 0.3s ease;
        }
        .package-card:hover .package-cta i {
            transform: translateX(4px);
        }

        /* FAQ */
        .faq-item details > summary {
            list-style: none;
        }
        .faq-item details > summary::-webkit-details-marker {
            display: none;
        }
        .faq-item .faq-icon {
            transition: transform 0.3s;
        }
        .faq-item details[open] .faq-icon {
            transform: rotate(45deg);
        }
        
        /* Deliverables Carousel */
        .deliverables-swiper .swiper-slide {
            cursor: pointer;
        }
        .swiper-pagination-bullet {
            background-color: var(--color-primary) !important;
            opacity: 0.5 !important;
        }
        .swiper-pagination-bullet-active {
            background-color: var(--color-accent) !important;
            opacity: 1 !important;
        }
        .swiper-button-next, .swiper-button-prev {
            color: var(--color-accent) !important;
            background-color: rgba(255,255,255,0.8);
            border-radius: 50%;
            width: 44px !important;
            height: 44px !important;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        .swiper-button-next::after, .swiper-button-prev::after {
            font-size: 18px !important;
            font-weight: 800;
        }
        .section-dark .swiper-button-next, .section-dark .swiper-button-prev {
            background-color: rgba(0,0,0,0.2);
            color: white !important;
        }
        .section-dark .deliverables-swiper .swiper-button-next,
        .section-dark .deliverables-swiper .swiper-button-prev {
            top: 10rem; /* h-80 is 20rem, so halfway is 10rem */
            transform: translateY(-50%);
        }
        .section-dark .swiper-pagination-bullet {
            background-color: white !important;
        }
         .section-dark .swiper-pagination-bullet-active {
            background-color: var(--color-accent) !important;
        }

        /* --- New Contact Cards --- */
        .contact-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            transition: all 0.3s ease;
            backdrop-filter: blur(5px);
            -webkit-backdrop-filter: blur(5px);
        }
        .contact-card:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-8px);
            border-color: rgba(255, 255, 255, 0.4);
        }
        
        /* Modal Package Contact Links */
        .modal-contact-card {
            @apply flex items-center gap-4 p-4 rounded-xl text-left transition-all duration-300;
        }
        .modal-contact-card.whatsapp {
            @apply bg-green-500 text-white;
        }
        .modal-contact-card.whatsapp:hover {
            @apply bg-green-600 shadow-lg scale-105;
        }
        .modal-contact-card.email {
            @apply bg-slate-700 text-white;
        }
        .modal-contact-card.email:hover {
            @apply bg-slate-800 shadow-lg scale-105;
        }


        /* Modal System */
        .modal-overlay {
            position: fixed;
            top: 0; right: 0; bottom: 0; left: 0;
            background-color: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 100;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease-in-out;
        }
        .modal-overlay.active {
            opacity: 1;
            pointer-events: auto;
        }
        .modal-content {
            background-color: white;
            padding: 2rem;
            border-radius: 1rem;
            width: 100%;
            max-width: 32rem;
            margin: 1rem;
            text-align: center;
            box-shadow: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            transform: scale(0.95);
            transition: transform 0.3s ease-in-out;
            position: relative;
        }
        .modal-overlay.active .modal-content {
            transform: scale(1);
        }
        .modal-close-btn {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-size: 1.5rem;
            line-height: 1;
            color: #94a3b8; /* slate-400 */
            transition: color 0.2s;
            z-index: 10;
            cursor: pointer;
        }
        .modal-close-btn:hover {
            color: #1e293b; /* slate-800 */
        }
        
        /* Portfolio Modal Swiper */
        #lightbox-modal .swiper-button-next,
        #lightbox-modal .swiper-button-prev {
            color: white !important;
            background-color: rgba(0,0,0,0.3);
        }
        
        /* Mobile menu link fix */
        #mobile-menu a.nav-link {
            color: white;
            font-size: 1.25rem;
            padding: 0.5rem;
            text-align: center;
        }

        /* PIX Modal Specific Styles */
        #pix-qrcode {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 1rem;
            border: 1px solid #e2e8f0;
            border-radius: 0.5rem;
            margin: 1rem auto;
            width: fit-content;
        }
        #pix-copy-paste {
            width: 100%;
            font-size: 0.8rem;
            padding: 0.5rem;
            border-radius: 0.5rem;
            border: 1px solid #cbd5e1;
            background-color: #f8fafc;
            word-break: break-all;
            resize: none;
        }
    </style>
</head>
<body class="overflow-x-hidden">

    <header id="main-header" class="fixed top-0 left-0 right-0 z-50">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <div id="logo-container" class="text-2xl font-bold text-white tracking-wide" style="font-family: var(--font-heading);"></div>
            <div class="hidden md:flex items-center space-x-8 text-white" id="nav-links">
                <a href="#solucoes" class="nav-link font-medium">Solu√ß√µes</a>
                <a href="#portfolio" class="nav-link font-medium">Portf√≥lio</a>
                <a href="#processo" class="nav-link font-medium">Processo</a>
                <a href="#pacotes" class="nav-link font-medium">Investimento</a>
                <a href="#faq" class="nav-link font-medium">FAQ</a>
            </div>
            <button id="mobile-menu-button" class="md:hidden text-white focus-outline-none z-50">
                <i id="menu-icon" class="ph-bold ph-list text-3xl"></i>
            </button>
        </nav>
         <div id="mobile-menu" class="fixed top-0 left-0 w-full h-full bg-[var(--color-secondary)] flex flex-col justify-center items-center gap-6 z-40 opacity-0 pointer-events-none transition-opacity duration-300 ease-in-out"></div>
    </header>

    <main>
        <!-- 1. Hero Section -->
        <section id="hero" class="relative text-white pt-40 pb-24 text-center flex items-center justify-center min-h-screen overflow-hidden">
            <video autoplay muted loop playsinline class="hero-bg-video">
                <source src="https://assets.mixkit.co/videos/preview/mixkit-architect-working-on-a-city-plan-4235-large.mp4" type="video/mp4">
            </video>
            <div class="absolute inset-0 bg-black/60 z-10"></div>
            <div class="container mx-auto px-6 z-20">
                <h1 id="hero-title" class="text-4xl md:text-6xl font-extrabold leading-tight" style="font-family: var(--font-heading);"></h1>
                <p id="hero-subtitle" class="mt-6 text-lg md:text-xl max-w-3xl mx-auto text-slate-300"></p>
                
                <div id="proposal-card" class="glass-card mt-12 max-w-4xl mx-auto p-6 grid grid-cols-1 sm:grid-cols-3 gap-6 text-left">
                    <div>
                        <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider">Cliente</h3>
                        <p id="client-name" class="text-xl font-semibold mt-1 text-white">Carregando...</p>
                    </div>
                    <div>
                        <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider">Data de Emiss√£o</h3>
                        <p id="proposal-date" class="text-xl font-semibold mt-1 text-white"></p>
                    </div>
                    <div>
                        <h3 class="text-sm font-bold text-slate-400 uppercase tracking-wider" id="proposal-validity-title"></h3>
                        <p id="proposal-validity" class="text-xl font-semibold mt-1 text-white"></p>
                    </div>
                </div>
            </div>
        </section>

        <div class="content-wrapper">
            <!-- Sections 2 to 12 -->
            <section id="pesadelos" class="py-20 md:py-28">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                        <h2 class="section-title text-3xl md:text-4xl font-extrabold">Os 3 Pesadelos de um Projeto Desintegrado</h2>
                        <p class="section-subtitle mt-4 text-lg">Evite os erros que transformam o sonho da constru√ß√£o em uma fonte de estresse e preju√≠zo.</p>
                    </div>
                    <div class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto">
                        <div class="bg-red-50 p-8 rounded-2xl border border-red-200">
                            <i class="ph-bold ph-timer text-4xl text-red-500"></i>
                            <h3 class="font-bold text-xl mt-4">Atrasos Intermin√°veis</h3>
                            <p class="mt-2 text-slate-600">Incompatibilidades entre projetos geram retrabalho constante, paralisando a obra e adiando a entrega das chaves.</p>
                        </div>
                        <div class="bg-red-50 p-8 rounded-2xl border border-red-200">
                            <i class="ph-bold ph-money text-4xl text-red-500"></i>
                            <h3 class="font-bold text-xl mt-4">Custos Explosivos</h3>
                            <p class="mt-2 text-slate-600">"Ajustes" no canteiro custam caro. A falta de planejamento leva √† compra de materiais errados e desperd√≠cio.</p>
                        </div>
                         <div class="bg-red-50 p-8 rounded-2xl border border-red-200">
                            <i class="ph-bold ph-shield-warning text-4xl text-red-500"></i>
                            <h3 class="font-bold text-xl mt-4">Riscos de Seguran√ßa</h3>
                            <p class="mt-2 text-slate-600">Improvisa√ß√µes comprometem a estrutura e as instala√ß√µes, colocando em risco seu patrim√¥nio e sua fam√≠lia.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section id="solucoes" class="py-20 md:py-28 section-dark">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                        <h2 class="section-title text-3xl md:text-4xl font-extrabold">Engenharia Integrada: A Solu√ß√£o Definitiva</h2>
                        <p class="section-subtitle mt-4 text-lg">Nossa metodologia garante que cada detalhe do seu projeto funcione em perfeita harmonia.</p>
                    </div>
                    <div class="max-w-5xl mx-auto">
                        <div class="tabs-container">
                            <div id="tabs-buttons" class="flex justify-start md:justify-center border-b border-slate-700 space-x-4 md:space-x-8 px-6 md:px-0"></div>
                        </div>
                        <div id="tabs-content" class="min-h-[300px] mt-8"></div>
                    </div>
                </div>
            </section>

            <section id="portfolio" class="py-20 md:py-28">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                        <h2 class="section-title text-3xl md:text-4xl font-extrabold">Portf√≥lio de Precis√£o</h2>
                        <p class="section-subtitle mt-4 text-lg">Qualidade e excel√™ncia que voc√™ pode ver, do residencial ao comercial.</p>
                    </div>
                    <div id="portfolio-filters" class="flex justify-center gap-4 mb-12">
                         <button class="filter-btn active" data-filter="all">Todos</button>
                         <button class="filter-btn" data-filter="residencial">Residencial</button>
                         <button class="filter-btn" data-filter="comercial">Comercial</button>
                    </div>
                    <div id="portfolio-grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8"></div>
                </div>
            </section>
            
            <section id="perfil" class="py-20 md:py-28 section-dark">
                <div class="container mx-auto px-6">
                    <div class="max-w-4xl mx-auto grid md:grid-cols-3 gap-12 items-center">
                        <div id="profile-image-container" class="md:col-span-1 flex justify-center"></div>
                        <div class="md:col-span-2">
                             <h2 class="section-title text-3xl md:text-4xl font-extrabold">Quem Voc√™ Est√° Contratando?</h2>
                             <div id="profile-content"></div>
                        </div>
                    </div>
                </div>
            </section>

            <section id="processo" class="py-20 md:py-28">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                        <h2 class="section-title text-3xl md:text-4xl font-extrabold">Nosso Processo de Trabalho</h2>
                        <p class="section-subtitle mt-4 text-lg">Uma jornada transparente e colaborativa, do conceito √† entrega final.</p>
                    </div>
                    <div id="timeline-container" class="max-w-2xl mx-auto"></div>
                </div>
            </section>

            <section id="entregaveis" class="py-20 md:py-28 section-dark">
                 <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                        <h2 class="section-title text-3xl md:text-4xl font-extrabold">O Que Voc√™ Recebe</h2>
                        <p class="section-subtitle mt-4 text-lg">Documenta√ß√£o t√©cnica clara e detalhada, pronta para uma execu√ß√£o sem erros no canteiro de obras.</p>
                    </div>
                    <div class="swiper deliverables-swiper max-w-6xl mx-auto relative">
                        <div class="swiper-wrapper" id="deliverables-carousel"></div>
                        <div class="swiper-button-next"></div>
                        <div class="swiper-button-prev"></div>
                        <div class="swiper-pagination mt-8 !relative"></div>
                    </div>
                </div>
            </section>
            
             <section id="garantias" class="py-20 md:py-28">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                        <h2 class="section-title text-3xl md:text-4xl font-extrabold">Nossas Garantias Inegoci√°veis</h2>
                         <p class="section-subtitle mt-4 text-lg">Compromissos que asseguram a sua tranquilidade e o sucesso do seu investimento.</p>
                    </div>
                    <div id="guarantees-container" class="grid md:grid-cols-3 gap-8 max-w-6xl mx-auto"></div>
                </div>
            </section>

            <section id="depoimentos" class="py-20 md:py-28 section-dark">
                 <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                         <h2 class="section-title text-3xl md:text-4xl font-extrabold">A Confian√ßa de Nossos Clientes</h2>
                    </div>
                    <div id="testimonials-container" class="grid md:grid-cols-2 gap-8 max-w-4xl mx-auto"></div>
                 </div>
            </section>


            <section id="pacotes" class="py-20 md:py-28 bg-slate-50">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                        <h2 class="section-title text-3xl md:text-4xl font-extrabold">Planos de Investimento</h2>
                        <p class="section-subtitle mt-4 text-lg">Escolha o plano que melhor se adapta √†s necessidades e √† complexidade do seu projeto.</p>
                    </div>
                    <div class="grid lg:grid-cols-3 gap-8 items-center max-w-6xl mx-auto" id="packages-container"></div>
                </div>
            </section>
            
             <section id="faq" class="py-20 md:py-28 section-dark">
                <div class="container mx-auto px-6">
                    <div class="text-center mb-16 max-w-3xl mx-auto">
                        <h2 class="section-title text-3xl md:text-4xl font-extrabold">Perguntas Frequentes</h2>
                        <p class="section-subtitle mt-4 text-lg">Respostas claras para as d√∫vidas mais comuns sobre o processo.</p>
                    </div>
                    <div id="faq-container" class="max-w-3xl mx-auto space-y-4"></div>
                </div>
            </section>

            <section id="contato" class="py-20 md:py-28 text-white" style="background: linear-gradient(135deg, var(--color-secondary) 0%, var(--color-primary) 100%);">
                <div class="container mx-auto px-6 text-center max-w-4xl">
                    <h2 class="text-4xl md:text-5xl font-extrabold" style="font-family: var(--font-heading);">Pronto para Construir com Seguran√ßa e Precis√£o?</h2>
                    <p class="mt-6 text-lg text-slate-300">D√™ o pr√≥ximo passo para transformar seu projeto em realidade. Entre em contato para formalizar o in√≠cio dos trabalhos.</p>
                    <div class="mt-16 max-w-4xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-8">
                        <a id="whatsapp-link" href="#" target="_blank" class="contact-card block p-8 text-left">
                            <div class="flex items-start gap-4">
                                <i class="ph-bold ph-whatsapp-logo text-4xl text-green-400"></i>
                                <div>
                                    <h3 class="text-2xl font-bold text-white">Conversar por WhatsApp</h3>
                                    <p class="mt-2 text-slate-300">Inicie uma conversa para alinharmos os detalhes finais do seu projeto.</p>
                                </div>
                            </div>
                        </a>
                        <a id="email-link" href="#" class="contact-card block p-8 text-left">
                            <div class="flex items-start gap-4">
                                <i class="ph-bold ph-envelope text-4xl text-cyan-400"></i>
                                <div>
                                    <h3 class="text-2xl font-bold text-white">Enviar um E-mail</h3>
                                    <p class="mt-2 text-slate-300">Prefere formalizar por e-mail? Envie sua mensagem diretamente para n√≥s.</p>
                                </div>
                            </div>
                        </a>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-8">
        <div class="container mx-auto px-6 text-center text-slate-400">
            <p>&copy; 2025 <span id="footer-company-name"></span>. Todos os direitos reservados.</p>
            <p class="text-sm mt-2">Proposta gerada para: <span id="footer-client-name" class="font-semibold"></span></p>
        </div>
    </footer>
    
    <div id="modal-container">
        <!-- Package Selection Modal -->
        <div id="package-modal" class="modal-overlay">
            <div class="modal-content">
                 <button class="modal-close-btn"><i class="ph-bold ph-x"></i></button>
                <div class="w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ph-bold ph-package text-4xl text-blue-600"></i>
                </div>
                <h2 class="text-2xl font-bold mb-2 text-gray-800">Detalhes do Pacote</h2>
                <p id="package-modal-name" class="font-bold text-lg text-slate-800 mb-4"></p>
                
                <div class="text-left bg-slate-50 p-4 rounded-lg mb-6 max-h-48 overflow-y-auto border">
                    <p class="font-semibold text-slate-600 mb-2">Itens inclusos:</p>
                    <ul id="package-modal-features" class="space-y-2"></ul>
                </div>

                <p class="text-slate-600 mb-6">Pr√≥ximo passo:</p>
                <div class="mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4">
                    <a id="package-whatsapp-link" href="#" target="_blank" class="modal-contact-card whatsapp">
                        <i class="ph-bold ph-whatsapp-logo text-3xl"></i>
                        <div>
                            <span class="font-bold">Contratar</span>
                            <span class="text-sm block">Fale conosco</span>
                        </div>
                    </a>
                    <a id="package-email-link" href="#" class="modal-contact-card email">
                        <i class="ph-bold ph-envelope text-3xl"></i>
                        <div>
                            <span class="font-bold">Tirar D√∫vidas</span>
                            <span class="text-sm block">Envie um e-mail</span>
                        </div>
                    </a>
                </div>
                <!-- NEW PIX PAYMENT BUTTON -->
                <div class="mt-6 pt-6 border-t border-gray-200">
                     <button id="package-pay-button" class="w-full bg-cyan-600 hover:bg-cyan-700 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition-colors duration-300">
                         <i class="ph-bold ph-qr-code text-xl"></i>
                         <span>Pagar 50% de Entrada via PIX</span>
                     </button>
                </div>
            </div>
        </div>
    
        <!-- Portfolio & Deliverables Modal (Lightbox with Swiper) -->
        <div id="lightbox-modal" class="modal-overlay">
            <div class="modal-content !p-0 !max-w-6xl bg-transparent shadow-none">
                <button class="modal-close-btn !text-white !top-2 !right-2 z-20 bg-black/30 rounded-full p-2"><i class="ph-bold ph-x text-2xl"></i></button>
                <div class="swiper lightbox-swiper w-full h-full">
                    <div class="swiper-wrapper" id="lightbox-slides"></div>
                    <div class="swiper-button-next"></div>
                    <div class="swiper-button-prev"></div>
                </div>
            </div>
        </div>

        <!-- NEW PIX PAYMENT MODAL -->
        <div id="pix-modal" class="modal-overlay">
            <div class="modal-content">
                <button class="modal-close-btn"><i class="ph-bold ph-x"></i></button>
                <div class="w-16 h-16 bg-cyan-100 rounded-full flex items-center justify-center mx-auto mb-4">
                    <i class="ph-bold ph-qr-code text-4xl text-cyan-600"></i>
                </div>
                <h2 class="text-2xl font-bold text-gray-800">Pagamento via PIX</h2>
                <p class="text-slate-600 mb-1">Entrada de <strong id="pix-down-payment-value" class="text-slate-800"></strong> para o</p>
                <p id="pix-package-name" class="font-bold text-lg text-slate-800 mb-4"></p>
                
                <div id="pix-qrcode" class="shadow-inner"></div>
                
                <div class="mt-4 text-left">
                    <label for="pix-copy-paste" class="text-sm font-medium text-slate-600">Ou copie o c√≥digo abaixo:</label>
                    <textarea id="pix-copy-paste" rows="4" readonly class="mt-1 bg-slate-100 border border-slate-300 rounded-md w-full p-2 text-xs text-slate-700 focus:ring-2 focus:ring-cyan-500"></textarea>
                </div>
                
                <button id="copy-pix-code-button" class="mt-4 w-full bg-slate-700 hover:bg-slate-800 text-white font-bold py-3 px-4 rounded-lg flex items-center justify-center gap-2 transition-colors duration-300">
                    <i class="ph-bold ph-copy"></i>
                    <span>Copiar C√≥digo</span>
                </button>
                <p class="mt-6 text-sm text-amber-700 bg-amber-50 p-3 rounded-lg">
                    <strong>Importante:</strong> Ap√≥s o pagamento, por favor, envie o comprovante via WhatsApp para darmos in√≠cio ao seu projeto.
                </p>
            </div>
        </div>
    </div>


<script type="module">
document.addEventListener('DOMContentLoaded', async () => {
    // --- CONFIGURA√á√ïES ---
    const GITHUB_RAW_BASE_URL = 'https://raw.githubusercontent.com/alixonc/proposta-comercial/main/';
    // SEUS DADOS DE CONTATO ATUALIZADOS
    const WHATSAPP_NUMBER = '5575998014491'; 
    const EMAIL_ADDRESS = 'alison.karvalho@gmail.com';

    let portfolioSwiperInstance = null;
    let deliverablesData = [];

    // --- UTILITY FUNCTIONS ---
    const resolveImageUrl = (path) => {
        if (!path || path.startsWith('http')) return path;
        const cleanPath = path.startsWith('/') ? path.substring(1) : path;
        return `${GITHUB_RAW_BASE_URL}${cleanPath}`;
    };

    const fetchData = async (url) => {
        try {
            const response = await fetch(url);
            if (!response.ok) throw new Error(`HTTP error! status: ${response.status}`);
            return await response.json();
        } catch (e) {
            console.error(`Fetch failed for ${url}:`, e);
            return null;
        }
    };
    
    const fetchAllContent = async () => {
        const dataFiles = ['config', 'hero', 'roi', 'solutions', 'sobre', 'timeline', 'entregaveis', 'guarantees', 'testimonials', 'packages', 'faq', 'portfolio'];
        const fetchPromises = dataFiles.map(file => fetchData(`${GITHUB_RAW_BASE_URL}_data/${file}.json`));
        const allData = await Promise.all(fetchPromises);
        
        const [
            config, hero, roi, solutions, sobre, timeline, entregaveis,
            guarantees, testimonials, packages, faq, portfolio
        ] = allData;

        if (!config || !hero || !solutions || !sobre || !timeline || !packages) {
             console.error("One or more main content files could not be loaded.");
             return null;
        }

        return {
            ...config, // Includes header, proposal_details, and new pix_details
            hero: hero,
            value_comparison: roi?.items,
            solutions: solutions,
            sobre: sobre,
            timeline: timeline?.items,
            entregaveis: entregaveis?.items,
            guarantees: guarantees?.items,
            testimonials: testimonials?.items,
            packages: packages?.items,
            faq: faq?.items,
            portfolio: portfolio?.items
        };
    };

    const content = await fetchAllContent();

    if (!content) {
        document.body.innerHTML = "<div class='h-screen w-screen flex items-center justify-center text-white bg-red-500'><h1>Erro ao carregar o conte√∫do da proposta. Por favor, recarregue a p√°gina.</h1></div>";
        return;
    }
    
    deliverablesData = (content.entregaveis || []).map(slide => ({ ...slide, image: resolveImageUrl(slide.image) }));
    const portfolioData = { items: content.portfolio || [] };


    const setText = (selector, text) => {
        const el = document.querySelector(selector);
        if (el && text !== undefined) el.textContent = text;
    };
    const setHtml = (selector, html) => {
        const el = document.querySelector(selector);
        if (el) el.innerHTML = html;
    };
    const render = (selector, data, template) => {
        const el = document.querySelector(selector);
        if (el && data) el.innerHTML = Array.isArray(data) ? data.map(template).join('') : template(data);
    };

    // --- PIX QR CODE GENERATION ---
    const generatePixPayload = (pixKey, recipientName, recipientCity, amount, txid = '***') => {
        const formatField = (id, value) => {
            const valueStr = String(value);
            const len = String(valueStr.length).padStart(2, '0');
            return `${id}${len}${valueStr}`;
        };
        
        // Trim whitespace from name and city
        const trimmedName = recipientName.trim();
        const trimmedCity = recipientCity.trim();

        const sanitizedName = trimmedName.normalize("NFD").replace(/[\u0300-\u036f]/g, "").substring(0, 25);
        const sanitizedCity = trimmedCity.normalize("NFD").replace(/[\u0300-\u036f]/g, "").substring(0, 15);

        const merchantAccountInfo = formatField('00', 'br.gov.bcb.pix') + formatField('01', pixKey);
        const amountFormatted = amount.toFixed(2);
        
        const payload = [
            formatField('00', '01'),
            formatField('26', merchantAccountInfo),
            formatField('52', '0000'),
            formatField('53', '986'),
            formatField('54', amountFormatted),
            formatField('58', 'BR'),
            formatField('59', sanitizedName),
            formatField('60', sanitizedCity),
            formatField('62', formatField('05', txid))
        ].join('');

        const payloadWithCrcPlaceholder = payload + '6304';
        
        let crc = 0xFFFF;
        for (let i = 0; i < payloadWithCrcPlaceholder.length; i++) {
            crc ^= (payloadWithCrcPlaceholder.charCodeAt(i) << 8);
            for (let j = 0; j < 8; j++) {
                if ((crc & 0x8000) !== 0) {
                    crc = ((crc << 1) ^ 0x1021);
                } else {
                    crc <<= 1;
                }
            }
        }
        crc &= 0xFFFF;
        const crc16 = crc.toString(16).toUpperCase().padStart(4, '0');

        return payload + `6304${crc16}`;
    };

    // --- INITIALIZE UI MODULES ---
    const initHeader = () => {
        const header = document.getElementById('main-header');
        window.addEventListener('scroll', () => header.classList.toggle('scrolled', window.scrollY > 50));
        setText('#logo-container', content.header.logo_text);
        setText('#footer-company-name', content.header.logo_text);
        const menuButton = document.getElementById('mobile-menu-button');
        const mobileMenu = document.getElementById('mobile-menu');
        const menuIcon = document.getElementById('menu-icon');
        mobileMenu.innerHTML = document.getElementById('nav-links').innerHTML;
        const toggleMenu = () => {
            const isOpening = mobileMenu.classList.contains('opacity-0');
            if (isOpening) {
                mobileMenu.classList.remove('opacity-0', 'pointer-events-none');
                mobileMenu.classList.add('opacity-100', 'pointer-events-auto');
                menuIcon.className = 'ph-bold ph-x text-3xl';
            } else {
                mobileMenu.classList.remove('opacity-100', 'pointer-events-auto');
                mobileMenu.classList.add('opacity-0', 'pointer-events-none');
                menuIcon.className = 'ph-bold ph-list text-3xl';
            }
        };
        menuButton.addEventListener('click', toggleMenu);
        mobileMenu.querySelectorAll('a').forEach(link => link.addEventListener('click', toggleMenu));
    };
    const initHeroAndProposalCard = () => {
        setText('#hero-title', content.hero.title);
        setText('#hero-subtitle', content.hero.subtitle);
        const params = new URLSearchParams(window.location.search);
        const clientName = params.get('cliente') || "Prezado(a) Cliente";
        const issueDate = new Date();
        const expiryDate = new Date(new Date().setDate(issueDate.getDate() + (content.proposal_details.validity_days || 15)));
        setText('#client-name', clientName);
        setText('#footer-client-name', clientName);
        setText('#proposal-date', new Date().toLocaleDateString('pt-BR'));
        setText('#proposal-validity-title', content.proposal_details.validity_text);
        setText('#proposal-validity', expiryDate.toLocaleDateString('pt-BR'));
    };
    const initSolutionsTabs = () => {
        if (!content.solutions) return;
        const solutions = Object.entries(content.solutions);
        render('#tabs-buttons', solutions, ([key, s]) => `<button class="tab-button font-semibold text-lg py-2 px-4" data-tab="${key}">${s.title}</button>`);
        render('#tabs-content', solutions, ([key, s]) => `
            <div id="tab-content-${key}" class="tab-content">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 md:gap-12 items-center">
                    <div class="md:order-2">
                        <h3 class="text-3xl font-bold">${s.title}</h3>
                        <p class="mt-4 leading-relaxed">${s.description}</p>
                        <ul class="mt-6 space-y-3">${(s.deliverables || []).map(d => `<li class="flex items-start"><i class="ph-fill ph-check-circle text-xl mr-3 mt-0.5 text-[var(--color-accent)]"></i><span>${d}</span></li>`).join('')}</ul>
                    </div>
                    <div class="mt-8 md:mt-0 md:order-1">
                        <img src="${resolveImageUrl(s.image) || `https://placehold.co/500x400/F8FAFC/1E293B?text=${encodeURIComponent(s.title)}`}" class="rounded-xl shadow-lg w-full h-auto aspect-[5/4] object-cover">
                    </div>
                </div>
            </div>`);
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const switchTab = (tabKey) => {
            tabButtons.forEach(btn => btn.classList.toggle('active', btn.dataset.tab === tabKey));
            tabContents.forEach(contentEl => contentEl.classList.toggle('active', contentEl.id === `tab-content-${tabKey}`));
        };
        document.querySelector('#tabs-buttons').addEventListener('click', e => e.target.matches('.tab-button') && switchTab(e.target.dataset.tab));
        if (solutions.length > 0) switchTab(solutions[0][0]);
    };
    const initPortfolio = () => {
        if (!portfolioData || !portfolioData.items) return;
        const renderPortfolio = (filter = 'all') => {
            const filteredItems = filter === 'all' ? portfolioData.items : portfolioData.items.filter(item => item.category === filter);
            render('#portfolio-grid', filteredItems, (item, index) => {
                const originalIndex = portfolioData.items.findIndex(p => p.title === item.title && p.image === item.image);
                return `
                <div class="group portfolio-card bg-white rounded-lg shadow-md overflow-hidden cursor-pointer" 
                     data-index="${originalIndex}" data-filter="${filter}">
                    <div class="overflow-hidden"><img src="${resolveImageUrl(item.image)}" alt="${item.title}" class="w-full h-64 object-cover transition-transform duration-500 group-hover:scale-110" loading="lazy"></div>
                    <div class="p-6">
                        <span class="text-sm font-semibold uppercase tracking-wider text-slate-500">${item.category}</span>
                        <h3 class="text-xl font-bold text-slate-800 mt-2">${item.title}</h3>
                    </div>
                </div>`;
            });
        };
        document.querySelector('#portfolio-filters').addEventListener('click', e => {
            if (e.target.matches('.filter-btn') && !e.target.classList.contains('active')) {
                document.querySelector('#portfolio-filters .filter-btn.active')?.classList.remove('active', 'bg-[var(--color-accent)]', 'text-white');
                e.target.classList.add('active', 'bg-[var(--color-accent)]', 'text-white');
                renderPortfolio(e.target.dataset.filter);
            }
        });
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.add('py-2', 'px-5', 'rounded-full', 'font-semibold', 'transition-colors', 'bg-slate-200', 'text-slate-700');
            if (btn.dataset.filter === 'all') btn.classList.add('active', 'bg-[var(--color-accent)]', 'text-white');
        });
        renderPortfolio();
    };
    const initProfile = () => {
        if (!content.sobre) return;
        const { name, bio, photo } = content.sobre;
        setHtml('#profile-image-container', `<img src="${resolveImageUrl(photo)}" alt="${name}" class="rounded-full w-48 h-48 md:w-64 md:h-64 object-cover shadow-2xl">`);
        setHtml('#profile-content', `<h3 class="text-2xl font-bold mt-4 md:mt-0">${name}</h3><p class="mt-4 leading-relaxed">${bio}</p>`);
    };
    const initTimeline = () => {
        if (!content.timeline) return;
        render('#timeline-container', content.timeline, item => `
            <div class="timeline-item">
                <div class="timeline-marker"></div>
                <div class="timeline-content">
                    <h3 class="text-xl font-bold text-slate-800">${item.title}</h3>
                    <p class="mt-2 text-slate-600">${item.description}</p>
                </div>
            </div>`);
        gsap.registerPlugin(ScrollTrigger);
        document.querySelectorAll('.timeline-item').forEach(item => {
            gsap.from(item.querySelector('.timeline-content'), {
                scrollTrigger: {
                    trigger: item,
                    start: "top 80%",
                    toggleClass: {targets: item, className: "in-view"},
                    once: true
                },
                opacity: 0, x: -30, duration: 0.6
            });
        });
    };
    const initDeliverablesCarousel = () => {
        render('#deliverables-carousel', deliverablesData, (slide, index) => `
            <div class="swiper-slide" data-index="${index}">
                <div class="bg-slate-800 rounded-lg shadow-lg overflow-hidden text-center">
                    <img src="${slide.image}" alt="${slide.title}" class="w-full h-80 object-contain p-4" loading="lazy">
                    <div class="p-4 text-white">
                        <h4 class="font-bold text-lg">${slide.title}</h4>
                        <p class="text-sm text-slate-400">${slide.category}</p>
                    </div>
                </div>
            </div>`);
        new Swiper('.deliverables-swiper', {
            loop: true, slidesPerView: 1, spaceBetween: 30, autoplay: { delay: 5000, disableOnInteraction: false },
            pagination: { el: '.swiper-pagination', clickable: true },
            navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
            breakpoints: { 768: { slidesPerView: 2 }, 1024: { slidesPerView: 3 } }
        });
    };
    const initGuarantees = () => render('#guarantees-container', content.guarantees, g => `<div class="text-center p-6"><i class="ph-bold ph-${g.icon} text-5xl text-[var(--color-accent)] inline-block"></i><h3 class="text-xl font-bold mt-4">${g.title}</h3><p class="mt-2 text-slate-600">${g.description}</p></div>`);
    const initTestimonials = () => render('#testimonials-container', content.testimonials, t => `<div class="bg-slate-800 p-8 rounded-xl shadow-lg"><i class="ph-fill ph-quotes text-4xl text-[var(--color-accent)]"></i><p class="text-lg italic text-slate-300 mt-4">"${t.text}"</p><p class="font-bold text-right mt-6 text-slate-200">${t.author}</p></div>`);
    const initPackages = () => render('#packages-container', content.packages, pkg => `
        <div class="package-card relative p-8 flex flex-col cursor-pointer ${pkg.recommended ? 'recommended' : ''}" data-modal-target="package-modal" data-package-name="${pkg.name}">
            ${pkg.recommended ? '<div class="absolute top-0 -translate-y-1/2 left-1/2 -translate-x-1/2 bg-[var(--color-accent)] text-white text-sm font-bold px-4 py-1 rounded-full uppercase tracking-wider">Recomendado</div>' : ''}
            <div class="flex-grow">
                <h3 class="text-2xl font-bold text-[var(--color-primary)]">${pkg.name}</h3>
                <p class="mt-2 text-slate-500 min-h-[3rem]">${pkg.description}</p>
                <p class="text-4xl font-extrabold my-6 text-[var(--color-primary)]">R$ ${pkg.price}</p>
                <ul class="space-y-3 text-slate-700 text-left">${(pkg.features || []).map(f => `<li class="flex items-start"><i class="ph-fill ph-check-circle text-green-500 text-xl mr-2 mt-0.5"></i><span>${f}</span></li>`).join('')}</ul>
            </div>
            <div class="package-cta mt-8 pt-6 border-t border-slate-200 text-center">
                <span class="font-bold text-lg ${pkg.recommended ? 'text-[var(--color-accent)]' : 'text-[var(--color-primary)]'}">
                    Selecionar Plano <i class="ph-bold ph-arrow-right align-middle"></i>
                </span>
            </div>
        </div>`);
    const initFaq = () => render('#faq-container', content.faq, item => `
        <div class="faq-item">
            <details>
                <summary class="p-5 flex justify-between items-center cursor-pointer font-semibold text-lg">${item.question}<i class="ph-bold ph-plus faq-icon text-2xl font-light text-[var(--color-accent)]"></i></summary>
                <div class="px-5 pb-5">${item.answer}</div>
            </details>
        </div>`);
    const initContactLinks = () => {
        const clientName = document.getElementById('client-name').textContent;
        const whatsappLink = document.getElementById('whatsapp-link');
        const emailLink = document.getElementById('email-link');
        const whatsappMessage = encodeURIComponent(`Ol√°, AC Engenharia. Gostaria de aprovar a proposta para "${clientName}".`);
        whatsappLink.href = `https://wa.me/${WHATSAPP_NUMBER}?text=${whatsappMessage}`;
        const emailSubject = encodeURIComponent(`Aprova√ß√£o da Proposta - ${clientName}`);
        emailLink.href = `mailto:${EMAIL_ADDRESS}?subject=${emailSubject}`;
    };

    const initModals = () => {
        const openModal = (modal) => modal?.classList.add('active');
        const closeModal = () => {
            document.querySelector('.modal-overlay.active')?.classList.remove('active');
        };

        const createLightboxSwiper = (slides, initialSlide) => {
            const lightboxModal = document.getElementById('lightbox-modal');
            render('#lightbox-slides', slides, slide => `
                <div class="swiper-slide flex items-center justify-center">
                    <div class="relative">
                        <img src="${slide.image}" alt="${slide.title}" class="w-auto h-auto max-w-[90vw] max-h-[85vh] object-contain rounded-lg">
                        <div class="absolute bottom-0 left-0 w-full p-6 bg-gradient-to-t from-black/80 to-transparent rounded-b-lg">
                           <h3 class="text-2xl font-bold text-white">${slide.title}</h3>
                           <p class="text-md text-slate-300 uppercase tracking-wider">${slide.category}</p>
                        </div>
                    </div>
                </div>`);
            if (portfolioSwiperInstance) portfolioSwiperInstance.destroy(true, true);
            portfolioSwiperInstance = new Swiper('.lightbox-swiper', {
                initialSlide,
                navigation: { nextEl: '.swiper-button-next', prevEl: '.swiper-button-prev' },
            });
            openModal(lightboxModal);
        };
        
        document.body.addEventListener('click', e => {
            const modalTrigger = e.target.closest('[data-modal-target="package-modal"]');
            if (modalTrigger) {
                const packageName = modalTrigger.dataset.packageName;
                setText('#package-modal-name', packageName);
                const selectedPackage = content.packages.find(p => p.name === packageName);
                if (selectedPackage?.features) {
                    render('#package-modal-features', selectedPackage.features, feature => `<li class="flex items-start text-sm text-slate-700"><i class="ph-fill ph-check-circle text-green-500 text-lg mr-2 mt-0.5"></i><span>${feature}</span></li>`);
                }
                const whatsappMsg = encodeURIComponent(`Ol√°! Tenho interesse no ${packageName} que vi na proposta.`);
                document.getElementById('package-whatsapp-link').href = `https://wa.me/${WHATSAPP_NUMBER}?text=${whatsappMsg}`;
                const emailSub = encodeURIComponent(`Interesse no ${packageName}`);
                document.getElementById('package-email-link').href = `mailto:${EMAIL_ADDRESS}?subject=${emailSub}`;
                openModal(document.getElementById('package-modal'));
            }

            const payButton = e.target.closest('#package-pay-button');
            if(payButton) {
                const pixModal = document.getElementById('pix-modal');
                const packageName = document.getElementById('package-modal-name').textContent;
                const selectedPackage = content.packages.find(p => p.name === packageName);
                const pixConfig = content.pix_details;

                if (!selectedPackage || !pixConfig || !pixConfig.pix_key) {
                    alert("As configura√ß√µes para pagamento PIX n√£o foram encontradas. Por favor, entre em contato.");
                    return;
                }
                
                const priceString = selectedPackage.price.replace(/\./g, '').replace(',', '.');
                const price = parseFloat(priceString);
                const downPayment = price / 2;
                
                setText('#pix-down-payment-value', downPayment.toLocaleString('pt-BR', { style: 'currency', currency: 'BRL' }));
                setText('#pix-package-name', `Pacote ${packageName}`);
                
                const clientName = (document.getElementById('client-name').textContent || 'Cliente').substring(0,10);
                const txid = `PROP-${clientName.replace(/[^A-Z0-9]/ig, '')}-${Date.now()}`.substring(0,25);

                const payload = generatePixPayload(
                    pixConfig.pix_key,
                    pixConfig.recipient_name,
                    pixConfig.recipient_city,
                    downPayment,
                    txid
                );

                document.getElementById('pix-copy-paste').value = payload;
                const qrcodeContainer = document.getElementById('pix-qrcode');
                qrcodeContainer.innerHTML = '';
                new QRCode(qrcodeContainer, { text: payload, width: 220, height: 220, correctLevel: QRCode.CorrectLevel.M });
                
                document.getElementById('package-modal').classList.remove('active');
                openModal(pixModal);
            }

            const copyBtn = e.target.closest('#copy-pix-code-button');
            if(copyBtn) {
                const textArea = document.getElementById('pix-copy-paste');
                textArea.select();
                document.execCommand('copy');
                const originalText = copyBtn.querySelector('span').textContent;
                copyBtn.querySelector('span').textContent = 'Copiado!';
                setTimeout(() => { copyBtn.querySelector('span').textContent = originalText; }, 2000);
            }

            const portfolioTrigger = e.target.closest('#portfolio-grid .portfolio-card');
            if (portfolioTrigger) {
                const { index, filter } = portfolioTrigger.dataset;
                const filteredItems = (filter === 'all' ? portfolioData.items : portfolioData.items.filter(item => item.category === filter))
                                      .map(item => ({ ...item, image: resolveImageUrl(item.image) }));
                const clickedItemOriginalIndex = parseInt(portfolioTrigger.dataset.index, 10);
                const clickedItem = portfolioData.items[clickedItemOriginalIndex];
                const actualIndexInFilteredList = filteredItems.findIndex(item => item.title === clickedItem.title && item.image === resolveImageUrl(clickedItem.image));
                createLightboxSwiper(filteredItems, actualIndexInFilteredList >= 0 ? actualIndexInFilteredList : 0);
            }

            const deliverablesTrigger = e.target.closest('.deliverables-swiper .swiper-slide');
            if(deliverablesTrigger) {
                const realIndex = deliverablesTrigger.dataset.swiperSlideIndex || deliverablesTrigger.dataset.index;
                createLightboxSwiper(deliverablesData, parseInt(realIndex, 10));
            }

            if (e.target.closest('.modal-close-btn')) closeModal();
            if (e.target.matches('.modal-overlay')) closeModal();
        });

        document.addEventListener('keydown', e => (e.key === "Escape") && closeModal());
    };

    // --- RUN ALL INITIALIZERS ---
    initHeader();
    initHeroAndProposalCard();
    initSolutionsTabs();
    initPortfolio();
    initProfile();
    initTimeline();
    initDeliverablesCarousel();
    initGuarantees();
    initTestimonials();
    initPackages();
    initFaq();
    initContactLinks();
    initModals();
});
</script>

</body>
</html>

